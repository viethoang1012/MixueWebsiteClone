<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="https://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{system/layout}">
<head>
    <meta charset="UTF-8">
    <title>Chỉnh Sửa Quyền - Tropical Favorites</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<section layout:fragment="main-content">
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <h1 class="mb-4">Chỉnh Sửa Quyền</h1>

                <!-- Hiển thị thông báo lỗi (nếu có) -->
                <div th:if="${errorMessage}" class="alert alert-danger" role="alert">
                    <span th:text="${errorMessage}"></span>
                </div>

                <!-- Form chỉnh sửa quyền -->
                <form th:action="@{/authorities/save}" method="post" th:object="${authorities}">
                    <input type="hidden" th:field="*{id}" />

                    <!-- Trường Username -->
                    <div class="mb-3">
                        <label for="username" class="form-label">Tên Người Dùng</label>
                        <select id="username" th:field="*{username}" class="form-control" placeholder="chọn tên người dùng">
                            <option th:each="user : ${users}"
                                    th:value="${user.username}"
                                    th:text="${user.username}"
                                    th:selected="${user.username == authorities.username}"></option>
                        </select>
                        <div class="text-danger mt-1" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></div>
                    </div>

                    <!-- Trường Authority -->
                    <div class="mb-3">
                        <label for="authority" class="form-label">Quyền</label>
                        <select id="authority" th:field="*{authority}" class="form-control" placeholder="chọn quền người dùng">
                            <option value="ROLE_ADMIN">ROLE_ADMIN</option>
                            <option value="ROLE_USER">ROLE_USER</option>
                            <option value="ROLE_SYSTEM">ROLE_SYSTEM</option>
                        </select>
                        <div class="text-danger mt-1" th:if="${#fields.hasErrors('authority')}" th:errors="*{authority}"></div>
                    </div>

                    <!-- Nút Submit và Hủy -->
                    <div class="mb-3">
                        <button type="submit" class="btn btn-success">Lưu</button>
                        <a th:href="@{/authorities/list-authorities}" class="btn btn-secondary ms-2">Hủy</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
</body>
</html>